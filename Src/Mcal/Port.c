/**********************************************************************************************************************
 *  FILE DESCRIPTION
 *  -----------------------------------------------------------------------------------------------------------------*/
/**        \file  Port.c
 *        \brief  Port Driver
 *
 *      \details The driver configure the selected pins
 *
 *
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  INCLUDES
 *********************************************************************************************************************/
#include "Std_Types.h"
#include "Port.h"
#include "Dio.h"

/**********************************************************************************************************************
*  LOCAL MACROS CONSTANT\FUNCTION
*********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL DATA 
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  GLOBAL DATA
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL FUNCTION PROTOTYPES
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL FUNCTIONS
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  GLOBAL FUNCTIONS
 *********************************************************************************************************************/


/******************************************************************************
* \Syntax          : Port_Init(const Port_Cfg_UserDefined* ConfigPtr)       
* \Description     : Initialize the pins with user-defined configuration                                   
*                                                                             
* \Sync\Async      : Synchronous                                               
* \Reentrancy      : Non Reentrant                                             
* \Parameters (in) : None                     
* \Parameters (out): None                                                      
* \Return value:   : None                                
*******************************************************************************/

void Port_Init(const Port_CfgType* ConfigPtr, uint16 ACTIVATED_PORT)
{
		for(uint8 i = 0; i < ACTIVATED_PORT; i++)
    {
      uint8 pinOffset = (ConfigPtr[i].pin)%8;
      uint8 portIndex = (ConfigPtr[i].pin)/8;
      SYSCTL_RCGCGPIO |= 1<<portIndex;                                            // Enable clock gating for port(portIndex)

			if(portIndex == DIO_PORT_F)
      {
        GPIOLOCK_PORTx_APB(portIndex) |= 0x4C4F434B;
        GPIOCR_PORTx_APB(portIndex)   |= 1<<pinOffset;
      }

      GPIODIR_PORTx_APB(portIndex) |= ((ConfigPtr[i].pinDirection)<<pinOffset);     // Enable pin(pinOffset) with state(pinDirection)
      GPIODEN_PORTx_APB(portIndex) |= ((ConfigPtr[i].pinMode)<<pinOffset);
      Dio_WriteChannel(ConfigPtr[i].pin, ConfigPtr[i].levelValue);

      if(ConfigPtr[i].pinInternalAttach != PORT_DEFAULT_IA)
      {
        switch (ConfigPtr[i].pinInternalAttach)
        {
          case PORT_ODR:
            GPIOODR_PORTx_APB(portIndex) |= 1<<pinOffset;
            break;
          case PORT_PUR:
            GPIOPUR_PORTx_APB(portIndex) |= 1<<pinOffset;
            break;
          case PORT_PDR:
            GPIOPDR_PORTx_APB(portIndex) |= 1<<pinOffset;
            break;
          default:
            break;
        }
      }
    }
}

/**********************************************************************************************************************
 *  END OF FILE: Port.c
 *********************************************************************************************************************/
